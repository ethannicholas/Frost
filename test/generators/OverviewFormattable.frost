method main() {
    try {
        def out := Console.outputStream()
        Console.inputStream().sendTo(out)
        out.printLine()
        out.printLine()
        out.printLine("class Weight : Formattable {")
        out.printLine("    def weight:Real")
        out.printLine()
        out.printLine("    init(weight:Real) {")
        out.printLine("        self.weight := weight")
        out.printLine("    }")
        out.printLine()
        out.printLine("    @override")
        out.printLine("    function format(fmt:String):String {")
        out.printLine("        match fmt {")
        out.printLine("            when \"kg\" {")
        out.printLine("                return \"\\{weight}kg\"")
        out.printLine("            }")
        out.printLine("            when \"lb\" {")
        out.printLine("                return \"\\{weight * 2.2}lb\"")
        out.printLine("            }")
        out.printLine("            otherwise {")
        out.printLine("                unreachable")
        out.printLine("            }")
        out.printLine("        }")
        out.printLine("    }")
        out.printLine("}")
        out.printLine()
        out.printLine("method main() {")
        out.printLine("    def f:Formattable := Weight(100)")
        out.printLine("    Console.printLine(f.format(\"kg\"))")
        out.printLine("    Console.printLine(f.format(\"lb\"))")
        out.printLine("}")
    }
    fail(error) {
        Console.printLine(error)
        System.exit(1)
    }
}